# Source Notes (Feb 20, 2026)

## High-confidence (direct code / chain / official docs)

1. Polymarket `CTFExchange` code path enforces nonce equality (`isValidNonce`) during order validation.
- Local source: `contracts/ctfexchange__0x4bfb41d5b3570defd03c39a9a4d8de6bd8b8982e/verified_source/src/exchange/mixins/NonceManager.sol`
- Local source: `contracts/ctfexchange__0x4bfb41d5b3570defd03c39a9a4d8de6bd8b8982e/verified_source/src/exchange/mixins/Trading.sol`

2. `matchOrders` / `fillOrder` are restricted by `onlyOperator` at exchange entry points.
- Local source: `contracts/ctfexchange__0x4bfb41d5b3570defd03c39a9a4d8de6bd8b8982e/verified_source/src/exchange/CTFExchange.sol`

3. Fee module path first calls `exchange.matchOrders(...)`, then fee refund logic.
- Local source: `contracts/negriskfeemodule__0x78769d50be1763ed1ca0d5e878d93f05aabff29e/verified_source/lib/exchange-fee-module/src/FeeModule.sol`
- Exact incident module source also fetched from PolygonScan:
  - `contracts/negriskfeemodule2__0xb768891e3130f6df18214ac804d4db76c2c37730/verified_source/FeeModule.sol`
  - `contracts/negriskfeemodule2__0xb768891e3130f6df18214ac804d4db76c2c37730/verified_source/ABI.json`

4. Confirmed failed tx to `Neg Risk Fee Module 2` (`0xb768...`) calling selector `0x2287e350`.
- Tx: `0xccba4c3668a87228c3cf8a84ea90b2f6893f7833317260ad6ae2b13f14b49362`
- Observed fields via RPC in `data/key_tx_details.json`: `status=0`, `to=0xb768...`, `selector=0x2287e350`, time `2026-02-19T02:12:40Z`.

5. In block window `83173550..83173620`, there are 16 reverted `matchOrders` calls to `0xb768...`.
- Dataset: `data/failed_match_orders_block_83173550_83173620.json`
- Generated by: `scripts/scan_match_orders.py`

6. Same sender (`0xcf7f...`) has surrounding successful calls before and after the failed tx.
- Dataset: `data/cf7f_sender_sequence_block_83173550_83173620.json`

7. Polymarket profile page for suspected wallet embeds activity records with tx hashes and PnL.
- Profile URL in data extraction script and `docs/links.md`
- Dataset: `data/profile_activity_0x6e7e.json`

## Medium-confidence (social / secondary reporting)

1. Public social claim thread with exploit narrative:
- https://x.com/itslirrato/status/2024444009851072961

2. Secondary summaries echo same narrative and mention affected bot workflows.
- https://dropstab.com/blog/polymarket-bug-negrisk-fee-module
- https://phemex.com/news/article/polymarket-hacked-due-to-offchain-and-onchain-sync-flaw-61575
- https://www.kucoin.com/news/flash/polymarket-hacked-due-to-off-chain-and-on-chain-sync-vulnerability

## Low-confidence / rejected indicators

1. Some socially-circulated tx hashes were not found via `eth_getTransactionByHash`.
- Example set from reposted articles: `0x45fd95...`, `0xfb97e3...`, `0x625bbd...`, `0xb03bec...`, `0xa51c6c...`
- Treat as unverified until confirmed on-chain.
