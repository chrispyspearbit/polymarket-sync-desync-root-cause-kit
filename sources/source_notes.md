# Source Notes (Feb 20, 2026)

## High-confidence (direct code / chain / official docs)

1. Polymarket `CTFExchange` code path enforces nonce equality (`isValidNonce`) during order validation.
- Local source: `contracts/ctfexchange__0x4bfb41d5b3570defd03c39a9a4d8de6bd8b8982e/verified_source/src/exchange/mixins/NonceManager.sol`
- Local source: `contracts/ctfexchange__0x4bfb41d5b3570defd03c39a9a4d8de6bd8b8982e/verified_source/src/exchange/mixins/Trading.sol`

2. `matchOrders` / `fillOrder` are restricted by `onlyOperator` at exchange entry points.
- Local source: `contracts/ctfexchange__0x4bfb41d5b3570defd03c39a9a4d8de6bd8b8982e/verified_source/src/exchange/CTFExchange.sol`

3. Fee module path first calls `exchange.matchOrders(...)`, then fee refund logic.
- Local source: `contracts/negriskfeemodule__0x78769d50be1763ed1ca0d5e878d93f05aabff29e/verified_source/lib/exchange-fee-module/src/FeeModule.sol`
- Exact incident module source also fetched from PolygonScan:
  - `contracts/negriskfeemodule2__0xb768891e3130f6df18214ac804d4db76c2c37730/verified_source/FeeModule.sol`
  - `contracts/negriskfeemodule2__0xb768891e3130f6df18214ac804d4db76c2c37730/verified_source/ABI.json`

4. Confirmed failed tx to `Neg Risk Fee Module 2` (`0xb768...`) calling selector `0x2287e350`.
- Tx: `0xccba4c3668a87228c3cf8a84ea90b2f6893f7833317260ad6ae2b13f14b49362`
- Observed fields via RPC in `data/key_tx_details.json`: `status=0`, `to=0xb768...`, `selector=0x2287e350`, time `2026-02-19T02:12:40Z`.

5. In block window `83173550..83173620`, there are 16 reverted `matchOrders` calls to `0xb768...`.
- Dataset: `data/failed_match_orders_block_83173550_83173620.json`
- Generated by: `scripts/scan_match_orders.py`

6. Same sender (`0xcf7f...`) has surrounding successful calls before and after the failed tx.
- Dataset: `data/cf7f_sender_sequence_block_83173550_83173620.json`

7. Polymarket profile page for suspected wallet embeds activity records with tx hashes and PnL.
- Profile URL in data extraction script and `docs/links.md`
- Dataset: `data/profile_activity_0x6e7e.json`

8. Direct nonce-desync proof in incident window:
- Dataset: `data/failed_nonce_mismatch_analysis.json`
- In-window failed `matchOrders`: `16`
- With at least one decoded nonce mismatch: `15`
- Recurring mismatch addresses:
  - `0x437eda540441a17af77852a9bb5f283682d02d3b` (7 txs)
  - `0x13078c4e7f32f8d8272030d1ad1cd7c362c13b7e` (5 txs)
  - `0x8cb943c4fa3052d9ba077d85c8527565be501f6a` (3 txs)

9. Same-window successful `incrementNonce()` calls on `NegRiskCTFExchange (0xc5d...)`:
- Dataset: `data/increment_nonce_calls_block_83173550_83173620.json`
- Txs:
  - `0x793ca7ccd0394a287259b873137888d88fc0a13b8074101df1c1c42bc70c16ac` (`0x8cb943...`)
  - `0xfa4c8ac2a7d8b59d118f5266c93a3a3f10a597e7de164c6c4a7e932bdfcd9876` (`0x437eda...`)
  - `0xc57d75fc86112338bf1c83b91da0eabd2369158e2240c1393ef803a0b8e85b68` (`0x13078c...`)
- Selector cross-check: `incrementNonce()` => `0x627cdcb9`

10. Anchor-level nonce transition is directly observable on-chain.
- Address: `0x437eda540441a17af77852a9bb5f283682d02d3b`
- `nonces(address)` on `0xc5d...`:
  - block `83173565` => `0`
  - block `83173566` => `1`
  - block `83173568` => `1`
- Failed anchor tx `0xccba...` at block `83173568` includes maker order nonce `0` for this address in decoded calldata.

## Medium-confidence (social / secondary reporting)

1. Public social claim thread with exploit narrative:
- https://x.com/itslirrato/status/2024444009851072961

2. Secondary summaries echo same narrative and mention affected bot workflows.
- https://dropstab.com/blog/polymarket-bug-negrisk-fee-module
- https://phemex.com/news/article/polymarket-hacked-due-to-offchain-and-onchain-sync-flaw-61575
- https://www.kucoin.com/news/flash/polymarket-hacked-due-to-off-chain-and-on-chain-sync-vulnerability

## Low-confidence / rejected indicators

1. Some socially-circulated tx hashes were not found via `eth_getTransactionByHash`.
- Example set from reposted articles: `0x45fd95...`, `0xfb97e3...`, `0x625bbd...`, `0xb03bec...`, `0xa51c6c...`
- Treat as unverified until confirmed on-chain.

2. One reverted tx in the 16-tx failed cluster is not nonce-related.
- Tx: `0x1a031c5a951bf14df4f3b65d1d76e034aeb3f56a7fd970b01a835150a7f94742`
- Trace decode (`debug_traceTransaction`, `callTracer`) shows:
  - top-level revert reason: `TRANSFER_FROM_FAILED`
  - nested revert reason (USDC transfer): `ERC20: transfer amount exceeds balance`
- This classifies the outlier as balance/transfer failure, not nonce mismatch.
